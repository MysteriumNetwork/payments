language: go
sudo: false

before_install:
  - sudo add-apt-repository -y ppa:ethereum/ethereum
  - sudo apt-get -y update
  - sudo apt-get -y install solc ethereum nodejs npm
  - curl https://raw.githubusercontent.com/golang/dep/master/install.sh | sh
  - npm install -g soljitsu

install:
  - scripts/deps.sh ensure

script:
  - scripts/test.sh -v
  - scripts/check_goimports.sh

before_deploy:
  - scripts/release.sh

deploy:
  - provider: releases
    file:
      #MystToken for testnet
      - "build/src/MystToken.sol"
      - "build/abi/MystToken.abi"
      - "build/bin/MystToken.bin"
      #Payments
      - "build/src/IdentityPromises.sol"
      - "build/abi/IdentityPromises.abi"
      - "build/bin/IdentityPromises.bin"
    skip_cleanup: true
    api_key: "$GIT_RELEASES_API_KEY"
    on:
      tags: true
      branch: master
